----
> 클래스는 생성자와 별도로 정적 팩토리 메소드 (staitc factory method)를 제공할 수 있다. 

평소에 `인스턴스를 새로 생성할때` public 생성자 혹은 builder 패턴을 이용해서 사용하는데 
정적 팩토리 메서드를 이용하여 ==객체 생성을 캡슐화 해 제공할 수 있다==

 ✔️ 용어 정리 
 * 생성자 (constructor)
	 : `new` 연산자를 통해 인스턴스를 생성할때 반드시 호출되고 제일 먼저 실행되는 메소드.
	   - ==인스턴스 변수 (필드 값)를 초기화 시키는 역할==
		[특징]
		- 생성자 앞에는 접근 제어자 (public) 만 올수 있음
		- 반환값이 없어 void 나 자료형 작성 X (메소드 => 자료형/void 필요)
 * 정적 팩토리 메서드
	 : 클래스의 인스턴스를 반환하는 단순한 정적 메서드 => ==객체를 생성하는 역할을 분리==
 * 인스턴스 

[예시]
LocalDate 클래스의 `of` 
```java
// LocalTime.class
...
public static LocalTime of(int hour, int minute) {
  ChronoField.HOUR_OF_DAY.checkValidValue((long)hour);
  if (minute == 0) {
    return HOURS[hour];
  } else {
    ChronoField.MINUTE_OF_HOUR.checkValidValue((long)minute);
    return new LocalTime(hour, minute, 0, 0);
  }
}
...

// hour, minutes을 인자로 받아서 9시 30분을 의미하는 LocalTime 객체를 반환한다.
LocalTime openTime = LocalTime.of(9, 30);
```

Enum 의 `valueOf`
```java
public enum Color {
  RED,
  BLUE;
}
...
Color redColor = Color.valueOf("RED");
Color blueColor = Color.valueOf("BLUE");
```

#### ⭐ 정적 팩터리 메서드가 생성자보다 좋은 장점 

> 1. 이름을 가질 수 있다. 

   ✔️ 생성자 넘기는 매개변수와 생성자 자체만으로 반환될 객체의 특성을 제대로 설명하지 못한다. 
       벗!`정적 팩토리 메서드`는 이름만 잘 지으면 반화 객체 특성을 쉽게 묘사 할 수 있다. 
       
 입력 매개변수 순서가 달라지는 경우 엉뚱한 것을 반환하는 실수가 생길수 있는 반명 정팩메를 이용하면 
 한 클래스에 시그니처가 같은 생성자 여러개가 필요하면 정적 팩터리 메서드로 바꾸고 각각의 차이를 잘 드러내는 이름을 지어주면 된다. 

```java
public class Product {
	private String name;

	public Product (String name) {
		this.name = name;
	}
	
	static Product nameOf(String name) {
		return new Product(name);
	}
}

public class Main {
	public static void main(String[] args) {
		// 생성자 
		Product p1 = new Product("book");
		// 정적 팩토리 메소드 사용 
		Product p2 = Product.nameOf("pencil");
	}
}

```

> 2. 호출 될 때마다 인스턴스를 새로 생성하지 않아도 된다. 

`불변 클래스(immutable class)` 는 인스턴스를 미리 만들어 놓거나 새로 생성 인스턴스를 캐싱하여 재활용하는 식으로 불필요한 객체 생성을 피할 수 있다. 
- 인스턴스 통제 (instance-controlled)
   - 싱글턴 (item3) 그리고 인스턴스화 불가 (noninstantiable; item4) 로 만들 수 있다. 
   - 불변 값 클래스(item 17) 동치(what is 동치) ==인스턴스가 단 하나뿐임을 보장==할 수 있다. 
	   📌Q. 동치 means ? 
	          `a== b` 일때만 `a.equals(b)` 성립 
	    📌Q. 불변 클래스 (immutable class)? 
		    - 변경이 불가능한 클래스, 가변적이지 않은 클래스 
		    - reference type 으로 `heap`영역에 생성 
			    - ==heap 영역에서 변경불가능한 것이지 재할당을 못하는 것==은 아니다. 
			    - 📌Q. 참조 heap 영역 객체가 바뀌는 것이지 heap 영역 값이 바뀌는 것은아니다
		   A. String a = "aa" => a = "bb" 변경했을때,
			"bb" 라는 새로운 객체가 생성되고 a 가 그것을 참조하게 된다. "aa"를 가지고 있는 객체는 아무도 참조하지 않기 때문에 GC 대상이 된다. 
		    - ex. String, Boolean, Integer, Float, Long 
		    - 장점) 생성자, 접근 메소드에 대한 방어 복사가 없고 멀티스레드 환경에서 동기화 처리없이 객체 공유가 가능하다 (Thread-safe)
		    - 단점) 객체가 가지는 값마다 새로운 객체가 필요해 ==메모리 누수와 새로운 객체를 계속 생성하기에 성능 저하를== 발생 시킬수 있다. 
		
- 열거타입(item 34) 는 인스턴스가 하나만 만들어짐을 보장한다. 
	- 인스턴스 통제는 플라이웨이트 패턴 [Gamma95] 근간 
		📌Q. what is ==flyweight pattern==? 
			데이터를 공유해서 메모리를 절약하는 패턴으로 공통으로 사용되는 객체는 한번만 사용되고, pool 에 의해서 관리/사용 되는 디자인 패턴이다. ex] JVM String Constant Pool 
	ex.`Boolean.valueOf()` => Flyweight Pattern/ Gamma95 비슷 기법
	
	📌Q. How 캐싱 사용 재활용 ?
		`enum`과 같이 자주 사용되는 요소의 개수가 정해져 있으면 
		해당 개수만큼 미리 생성해놓고 조회(캐싱) 구조를 만든다. 
			✔️정적 메소드 + 캐싱 => 새로운 객체 생성 필요 X
		- 객체 생성 부담 줄일 수 있음
		- 생성자의 접근 제한자를 `private`로 설정하여 객체 생성을 정적 팩토리 메서로 가능하도록 제한 

> 3. 반환 타입의 하위 타입 객체를 반환할 수 있는 능력이 있다. 

장점 -> 유연성 
구현 클래스를 공개하지 않고 객체를 반환할수 있어 API 를 작게 유지 


> 4. 입력 매개변수에 따라 매번 다른 클래스의 객체를 반환 할 수 있다. 

> 5. 정적 팩터리 메서드를 작성하는 시점에서 반환할 객체의 클래스가 존재하지 않아도 된다. 



[궁금한게]
📌Q. `방어적 복사 (defensive copy)`란?
				객체 외부에서 참조 값을 통해 자유롭게 내부 값을 변경할수 있기에 고려
[예시]
❌ Don't ] 참조된 Cars 내부의 `final`로 참조한 값과 List< Cars> 를 생성하게 되면 
				동일한 객체를 참조한다. 
				필드를 불변으로 만드려고 했으나 ==객체 변경을 위한 메서드를 만들지 않았음에도 객체는 완전히 변경 가능한 객체==가 되었고 참조를 주고 받는 경우에도 ==변경에 취약하며 외부의 잘못된 사용에 그대로 노출== 가능하다. 
```java
public class Cars {
	private final List<Cars> cars;
	
	public Cars(List<Cars> cars) {
		this.cars = cars;
	}
	
	public List<Cars> getCars() {
		return cars;
	}
}
```

⭕ Do ] 방어적 복사를 하고 복사된 객체를 필드에 할당 
```java
	public Cars(List<Cars> cars) {
	// immitable collection 반환 
	this.cars = List.copyOf(cars);
	// or 
	this.cars = new ArrayList<>(cars); // 이 방법은 가능하나 변경 가능 
}
```

📌Q.  static 에 계속 올라와 있을텐데 그러면 메모리? 이런 문제는 없을까?

[연관 item]
item 3
item 4
item 17
item 34



https://exponential-e.tistory.com/71
https://kangworld.tistory.com/200
