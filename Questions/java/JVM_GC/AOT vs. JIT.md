----
#### ğŸŒˆ JIT

==ì‹¤í–‰ì„ ìœ„í•´ ì ì‹œ==ì— TypeScriptë¥¼ ì»´íŒŒì¼í•©ë‹ˆë‹¤.
-   ë¸Œë¼ìš°ì €ì—ì„œ ì»´íŒŒì¼ë©ë‹ˆë‹¤.
-   ê° íŒŒì¼ì€ ë³„ë„ë¡œ ì»´íŒŒì¼ë©ë‹ˆë‹¤.
-   ì½”ë“œë¥¼ ë³€ê²½ í•œ í›„ ë¸Œë¼ìš°ì € í˜ì´ì§€ë¥¼ ë‹¤ì‹œë¡œë“œí•˜ê¸° ì „ì— ë¹Œë“œ í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
-   ì§€ì—­ ê°œë°œì— ì í•©í•©ë‹ˆë‹¤.

#### ğŸŒˆ AOT

==ë¹Œë“œ ë‹¨ê³„==ì—ì„œ TypeScriptë¥¼ ì»´íŒŒì¼í•©ë‹ˆë‹¤.
-   ì‹œìŠ¤í…œ ìì²´ì—ì„œ ëª…ë ¹ ì¤„ì„ í†µí•´ ì»´íŒŒì¼ë©ë‹ˆë‹¤ (ë¹ ë¥¸ ì†ë„).
-   ëª¨ë“  ì½”ë“œëŠ” í•¨ê»˜ ì»´íŒŒì¼ë˜ì–´ ìŠ¤í¬ë¦½íŠ¸ì— HTML / CSSë¥¼ ì‚½ì…í•©ë‹ˆë‹¤.
-   ì»´íŒŒì¼ëŸ¬ë¥¼ ë°°í¬ í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤ (Angular í¬ê¸°ì˜ ì ˆë°˜).
-   ë” ì•ˆì „í•œ ì›ë³¸ ì†ŒìŠ¤ëŠ” ê³µê°œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
-   í”„ë¡œë•ì…˜ ë¹Œë“œì— ì í•©í•©ë‹ˆë‹¤.

![[Pasted image 20221226142941.png]]

#### > Compile 
ì»´íŒŒì¼ì€ Java ì™€ Python ê°™ì´ ê³ ìˆ˜ì¤€ ì–¸ì–´ì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ê¸°ê³„ì–¸ì–´ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. 
ì»´íŒŒì¼ëŸ¬ì˜ ëª©ì ì€ ì¼ê´€ëœ ì‹¤í–‰ íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ê²ƒì´ë©° ì†ŒìŠ¤ì½”ë“œê°€ ë¹ ë¥´ê³  ì•ˆì „í•˜ê²Œ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ë‹¤. 

ì»´íŒŒì¼ëŸ¬ëŠ” ë‹¤ì–‘í•œ ìµœì í™”ë¥¼ ê¸°ê³„ì–´ ìƒì„±í•˜ë©° ìˆ˜í–‰í•œë‹¤. 
ex. constant inlining, loop unrolling, partial evaltion 

> c1ê³¼ c2 compiler? 

Java Hotspot VM ì•ˆì˜ ë©”ì´ì € ì»´í”Œë¼ì´ì–´ëŠ” c1 complier ê³¼ c2 complier ì´ë‹¤. 
ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ ë  ë•Œ JVM ì€ JIT ì»´íŒŒì¼ëŸ¬ë¥¼ í†µí•´ í•«ì½”ë“œë¥¼ ê°„ì†Œí™” ì‹œí‚¨ë‹¤. 
ì½”ë“œê°€ ìì£¼ íš¨ìœ¨ì ì´ì§€ ì•Šê²Œ ì‘ì„±ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— 
JIT ì»´íŒŒì¼ëŸ¬ëŠ” C1 & C2 ì»´íŒŒì¼ëŸ¬ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•´ì„œ ì½”ë“œ íš¨ìœ¨ì„±ì„ ìµœì í™” ì‹œí‚¨ë‹¤. 
C1/C2 ì»´íŒŒì¼ëŸ¬ê°€ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ ê³µê°„ì€ "Code Cache" ë¼ê³  ë¶ˆë¦°ë‹¤. 

JIT ì»´íŒŒì¼ëŸ¬ê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œ `í´ë¼ì´ì–¸íŠ¸ JIT`ëŠ” ì½”ë“œ ì»´íŒŒì¼ì„ ì‹œì‘í•œë‹¤. 
`server JIT`ëŠ” íŠ¹ì • íƒ€ì„ì—ë§Œ ì‹¤í–‰ë˜ëŠ”ë° ì„œë²„ JIT ê°€ ì‹œê°„ì€ ë” ê±¸ë¦¬ì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ JIT ë³´ë‹¤ ì„±ëŠ¥ì€ ì¢‹ë‹¤. 
JDK ëŠ” í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ JIT ì»´íŒŒì¼ëŸ¬ ë¥¼ ì‚¬ìš©í•´ì„œ ì½”ë“œë¥¼ (streamline)ê°„ì†Œí™” í•œë‹¤. 
 1) í´ë¼ì´ì–¸íŠ¸ JIT ì»´íŒŒì¼ëŸ¬ ì½”ë“œ ì»´íŒŒì¼
 2) ì¶©ë¶„í•œ ë°ì´í„° í™•ë³´ ë˜ë©´ ... ì„œë²„ JIT ì»´íŒŒì¼ëŸ¬ ì‘ë™ 
-- JVM ì˜ ê³„ì¸µí™”ëœ ì»´íŒŒì¼ë§ : ==C1 -> client // C2 -> server ==

Q. JVM ì€ OAT ë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€? 
AOT ëŠ” ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ ì›ì‹œ ì½”ë“œë¥¼ ==ë™ì ìœ¼ë¡œ ìƒì„±í•˜ë©° ê³µìœ  ë°ì´í„° ìºì‹œ==ì—ì„œ ìƒì„±ëœ AOT ì½”ë“œë¥¼ ìºì‹œí•˜ê³ 
ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” í›„ì† JVM ì€ JIT  ì»´íŒŒì¼ ì›ì‹œ ì½”ë“œì—ì„œ ë°œìƒí•˜ëŠ” ì„±ëŠ¥ ì €í•˜ ì—†ì´ 
ê³µìœ  ë°ì´í„° ìºì‹œì—ì„œ AOT ì½”ë“œë¥¼ ë¡œë“œí•˜ê³  ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤. 

> ğŸ“Œ C1 Compiler 

ë¹ ë¥´ê³  ê°€ë³ê²Œ ìµœì í™”ëœ ë°”ì´íŠ¸ ì½”ë“œ ì»´íŒŒì¼ëŸ¬ ì‹¤í–‰ 
ex. some value numbering, inlining, class analysis 
âœ… JIT ì»´íŒŒì¼ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” ìŠ¤ë ˆë“œ 

[ì‚¬ìš©]
* GFC oriented SSA "high" IR  => CGG ì§€í–¥ì ì¸ SSAì™€ ê³ ìˆ˜ì¤€ì˜ ì¤‘ê°„ í‘œí˜„
* machine oriented "low" IR => ê¸°ê³„ ì§€í–¥ì ì¸ ì €ìˆ˜ì¤€ IR
* ì„ í˜• ìŠ¤ìº” ë ˆì§€ìŠ¤í„° í• ë‹¹ ë° í…œí”Œë › ìŠ¤íƒ€ì¼ ì½”ë“œ ìƒì„±ê¸° 

> ğŸ“Œ C2 Compiler 

âœ… JIT ì»´íŒŒì¼ëŸ¬ ì„œë²„ê°€ ì‚¬ìš©í•˜ëŠ” ìŠ¤ë ˆë“œ 

ë…¸ë“œì˜ ë°”ë‹¤ SSA ì™€ IR ì„ ì‚¬ìš©í•˜ëŠ” ê³ ë„ë¡œ ìµœì í™”ëœ ë°”ì´íŠ¸ ì½”ë“œ ì»´íŒŒì¼ëŸ¬ì´ë©° IR ì€ ë™ì¼í™˜ ì¢…ë¥˜ì˜ ê¸°ê³„ë³„ IRë¡œ ë‚®ì•„ì§„ë‹¤. 
- ê·¸ë˜í”„ ìƒ‰ì¹  ë ˆì§€ìŠ¤í„° í• ë‹¹ì
- ìƒ‰ìƒì€ ë¡œì»¬, ê¸€ëŸ¬ë²Œ, ì¸ìˆ˜ ë ˆì§€ìŠ¤í„°ì™€ ìŠ¤íƒì„ í¬í•¨í•œ ê¸°ê³„ì˜ ìƒíƒœì´ë‹¤. 
* global value numbering, conditional constant type propagation, constant folding, global code motion, algebraic identities, method inlining (aggressive, optimistic, and/or multi-morphic), intrinsic replacement, loop transformations (unswitching, unrolling), array range check elimination, and others.

> compiler ì‹¤í–‰ ì‹œê°„

* compiler strategy : JIT / AOT 

ìë°” ì†ŒìŠ¤ ì½”ë“œëŠ” ì²˜ìŒ ë°”ì´íŠ¸ ì½”ë“œë¡œ ë³€í™˜ ì´í›„ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ë³€í™˜ëœë‹¤. 
ë¬´ê±°ìš´ ìµœì í™”ëŠ” JIT ì»´íŒŒì¼ ë™ì•ˆì— ì‹¤í–‰ëœë‹¤. 

#### > JIT ì»´íŒŒì¼ëŸ¬ (ë™ì  ì»´íŒŒì¼ëŸ¬)ë¥¼ ì–´ë–»ê²Œ ìµœì í™” í•˜ëŠ”ê°€? 

![[Pasted image 20221227172610.png]]

âœ… compilation tier
- c1 : level 1-3
- c2 : level 4 

	0: ì¸í„°í”„ë¦¬íŠ¸ëœ ì½”ë“œ
	1: ë‹¨ìˆœ C1 ì»´íŒŒì¼ëœ ì½”ë“œ
	2: ì œí•œëœ C1 ì»´íŒŒì¼ëœ ì½”ë“œ
	3: ì „ì²´ C1 ì»´íŒŒì¼ëœ ì½”ë“œ
	 ğŸ”º ì „í˜•ì ì¸ ì½”ë“œëŠ” 3ë ˆë²¨ì¸ ì „ì²´ C1 ì»´íŒŒì¼ëœ ì½”ë“œë¡œ ì²˜ìŒ ì»´íŒŒì¼ 
	4: C2 ì»´íŒŒì¼ëœ ì½”ë“œ

âœ… Profiling 
jvm ì€ í•´ë‹¹ ì½”ë“œë¸”ë¡ì´ ì–´ë–¤ ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í• ì§€ [1] ì½”ë“œ ì‚¬ìš© ë¹ˆë„ [2] complexity/time consuming í† ëŒ€ë¡œ ê²°ì •í•œë‹¤. 
- ê¸°ë³¸ì ìœ¼ë¡œ C1 ì»´íŒŒì¼ëŸ¬ ì‚¬ìš© but! level 4 ë„ë‹¬í•˜ë©´ C2 ì‚¬ìš© 
- C2 ê°€ ë” ìµœì í™”ëœ ì½”ë“œ ìƒì„±
- JVM ì—ì„œ í•´ë‹¹ ì½”ë“œë¥¼ `code cache` ì— ì €ì¥í• ì§€ ê²°ì • 
- ëª¨ë“  ì½”ë“œë¥¼ level 4ë¡œ ì»´íŒŒì¼ í•˜ì§€ ì•Šìœ¼ë©° comple í•œ ì‘ì—…ì„ ë‹´ë‹¹ ì½”ë“œê°€ ì•„ë‹ˆë¼ë©´ ìì£¼ ì“°ì—¬ë„ `code cache`ì— ë„£ì§€ ì•ŠìŒ 
	=> ì´ì ì´ ë³„ë¡œ ì—†ë‹¤. 
	 - code cache ëŠ” í¬ê¸°ê°€ ì œí•œë˜ì–´ ìˆë‹¤. 


[ì°¸ê³ ]
c1,c2 ì´ìš©í•œ ìµœì í™”
https://kotlinworld.com/307
https://www.cogentinfo.com/blog/jvm-c1-c2-compiler-thread-high-cpu-consumption
https://shirohoo.github.io/backend/java/2022-07-16-aot-vs-jit-in-java/
